const Discord = require("discord.js");
var cmdFile;
var helpNames = [];

// Help command
exports.run = (client, msg) => {
  var embed = new Discord.RichEmbed()
                  .setTitle("testbot help")
                  .setFooter("Made by @Dotor Matriss#6350")
                  .setDescription("Help for testbot\nAll commands use the prefix " + client.config.prefix + "\n`<This is an optional argument>\n[This is a required argument]`\nFor more help please use:\n`" + client.config.prefix + "help <command>`");
  
  if (!client.args || client.args.length < 1 || !client.config.cmds.includes(client.args[0])) {
    for (var i = 0; i < client.config.cmds.length; i++) {
      cmdFile = require("cmds/" + client.config.cmds[i] + ".js");
      helpNames.push(cmdFile.help.name);
    }
    embed.addField("Commands", "```" + helpNames.join("\n") + "```");
  } else if (client.config.cmds.includes(client.args[0])) {
    cmdFile = require("cmds/" + client.args[0] + ".js");
    embed.setTitle(cmdFile.help.name);
    embed.setDescription(cmdFile.help.desc);
    embed.addField("Usage", "`" + client.config.prefix + cmdFile.help.use + "`");
  }
  
  msg.channel.send(embed);
  delete require.cache[require.resolve("./help.js")];
}

// CMD Help info
exports.help = {
  "name": "Help",
  "desc": "Displays help about the different bot commands",
  "use": "help <command>"
}